<%= render 'shared/navbar' %>
<div class="meeting-point"><p>📍 <%= @geographic_center %></p></div>

<div class="top-div">
  <div id="map" data-markers="<%= @markers.to_json %>" style="width: 100%;
    height: 40vh;"></div>
</div>

<div class="container">
  <div class="cards">
    <% @results_restaurants.each do |result|%>
      <%= link_to restaurant_path(result, event: params[:event]) do %>

      <% if result.photo.attached? %>
        <div class="card-trip mx-3">
            <%= cl_image_tag result.photo.key , alt: "photo restaurant" %>
          <div class="card-trip-infos">
            <div>
              <p> <%= result.name %> </p>
              <% if result.rating %>
                <p>
                  <% result.rating.times do%>
                    <i class="fas fa-star"></i>
                  <% end %>
                  <% (5 - result.rating).times do %>
                    <i class="fas fa-star" id="level-missing"></i>
                  <% end %>
                </p>
              <% end %>
              <p> <%= result.short_address %></p>
            </div>
            <h2 class="card-trip-pricing"><%= ("€"*result.price_level.to_i) %></h2>
          </div>
        </div>
      <% end %>
      <% end %>
    <% end %>
  </div>
</div>

<div class="bottom-div mt-4">
    <div class="btn-middle">
      <button type="button" class="btn-lesconvives" data-toggle="modal" data-target="#exampleModalCenter">
        Apply filters
        <i class="fas fa-plus-circle"></i>
      </button>

    </div>

  </div>


<!-- Modal filtre -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="exampleModalCenterTitle">Filter Restaurants</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <%= form_tag restaurants_path, method: :get do %>
        <div class="modal-body">
          <%= select_tag :food_category,
            options_for_select(Restaurant::CATEGORY),
            include_blank: true,
            class: "form-control"
          %>
          <%= select_tag :rating,
            options_for_select(Restaurant::RATINGS),
            class: "form-control"
          %>
          <%= select_tag :price_level,
            options_for_select(Restaurant::PRICE_LEVEL),
            class: "form-control"
          %>
        </div>
        <div class="modal-footer">
          <%= submit_tag "Search", class: "btn btn-primary" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
